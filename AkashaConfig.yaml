dns:
  enable: true
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - +.+m2m
    - +.$injections.adguard.org
    - +.$local.adguard.org
    - +.+bogon
    - +.+lan
    - +.+localdomain
    - +.home.arpa
    - dns.msftncsi.com
    - "*.srv.nintendo.net"
    - "*.stun.playstation.net"
    - xbox.*.microsoft.com
    - "*.xboxlive.com"
    - "*.turn.twilio.com"
    - "*.stun.twilio.com"
    - stun.syncthing.net
    - stun.*
    - "*.sslip.io"
    - "*.nip.io"
  respect-rules: true
  nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
  nameserver-policy:
    geosite:cn:
        - https://1.12.12.12/dns-query
        - https://223.5.5.5/dns-query
  proxy-server-nameserver:
    - https://1.12.12.12/dns-query
    - https://223.5.5.5/dns-query

proxy-providers:
  eggtart:
    url: "https://45.137.181.206/api/v1/client/subscribe?token=6010ec506e1ec4370dfa1f8fbdb44b72"
    type: http
    interval: 86400
    health-check: {enable: true,url: "https://www.gstatic.com/generate_204",interval: 300}
    override:
      additional-prefix: "【蛋挞】"
  
  milk:
    url: "https://sub.6rguyesfdhvbz.uk/api/v1/client/subscribe?token=2da5f1eccceff9778710b5fb480a2b9e"
    type: http
    interval: 86400
    health-check: {enable: true,url: "https://www.gstatic.com/generate_204",interval: 300}
    override:
      additional-prefix: "【MILK】"

  ikuuu:
    url: "https://b67vt.no-mad-world.club/link/AAkoK0lWLhvo21gm?clash=3&extend=1"
    type: http
    interval: 86400
    health-check: {enable: true,url: "https://www.gstatic.com/generate_204",interval: 300}
    override:
      additional-prefix: "【ikuu】"

# -------------------------------------------------------
# 规则集模板定义 (RuleSet Template Definitions)
# classical: 匹配域名或 IP 的规则类型
RuleSet_classical: &RuleSet_classical {type: http, behavior: classical, interval: 43200, format: text, proxy: 🚀 Proxy}
# domain: 仅匹配域名的规则类型
RuleSet_domain: &RuleSet_domain {type: http, behavior: domain, interval: 43200, format: text, proxy: 🚀 Proxy}
# ipcidr: 匹配 CIDR 格式 IP 段的规则类型
RuleSet_ipcidr: &RuleSet_ipcidr {type: http, behavior: ipcidr, interval: 43200, format: text, proxy: 🚀 Proxy}

# -------------------------------------------------------
# 代理组配置 (proxy-groups)
proxy-groups:
  # 主代理选择组 (Main Proxy Selection): 用于大部分需要代理的流量，用户可手动选择节点或策略
  - name: 🚀 Proxy
    type: select
    proxies:
      # 自动测速选择最佳节点
      - ♻️ Auto
      # 备用策略，当前一个策略失败时使用
      - ⚙️ Fallback
      # 各地区节点选项
      - 🇭🇰 HK
      - 🇼🇸 TW
      - 🇺🇸 US
      - 🇯🇵 JP
      - 🇸🇬 SG
      # 其他未明确分类的节点
      - 🏴‍☠️ Other
      # 低倍率节点选项 (新增)，用于下载和大流量
      - 📉 Low Rate

  # Telegram 代理组: 特定用于 Telegram 流量
  # 根据当前配置，此组筛选包含新加坡关键词的节点
  - name: ✈️ Telegram
    type: select
    # 筛选包含“新加坡”、“新”、“坡”且非 Hy2 的节点
    filter: "(?i)(?=.*(🇸🇬|新|坡))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Google 代理组: 用于非 YouTube 的 Google 服务
  - name: 🌐 Google
    type: select
    proxies:
      # 可选择主代理策略或特定地区节点
      - 🚀 Proxy
      - 🇭🇰 HK
      - 🇼🇸 TW
      - 🇺🇸 US
      - 🇯🇵 JP
      - 🇸🇬 SG
      - 🏴‍☠️ Other
      - 📉 Low Rate

  # YouTube 代理组 (New): 特定用于 YouTube 流量
  # 根据用户要求，筛选香港和台湾节点
  - name: ▶️ YouTube
    type: select
    # 筛选包含“香港”、“hk”、“台”、“tw”且非 Hy2 的节点
    filter: "(?i)(?=.*(香港|hk|台|tw))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Hong Kong Nodes: 筛选所有香港节点
  - name: 🇭🇰 HK
    type: select
    filter: "(?i)(?=.*(香港|hk))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Taiwan Nodes: 筛选所有台湾节点
  - name: 🇼🇸 TW
    type: select
    filter: "(?i)(?=.*(台|tw))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # US Nodes: 筛选所有美国节点
  - name: 🇺🇸 US
    type: select
    filter: "(?i)(?=.*(美|us))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Japan Nodes: 筛选所有日本节点
  - name: 🇯🇵 JP
    type: select
    filter: "(?i)(?=.*(日|jp))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Singapore Nodes: 筛选所有新加坡节点
  - name: 🇸🇬 SG
    type: select
    filter: "(?i)(?=.*(新|sg))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Other Nodes: 筛选不属于上述特定地区，且不包含特定排除关键词的节点
  # 作为前面地区组的补充
  - name: 🏴‍☠️ Other
    type: select
    # 筛选不包含特定词汇（官网、剩余、流量、套餐、.com、各主要地区关键词）且非 Hy2 的节点
    filter: "(?i)(?=.*(^(?!.*(官网|剩余|流量|套餐|.com|香港|hk|台|tw|美|us|坡|新|sg|日|jp|下方)).*$))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Low Rate Nodes (New): 筛选排除高倍率关键词的节点，用于下载和大流量
  - name: 📉 Low Rate
    type: select
    # 筛选不包含“家宽”、“专线”、“乘2”、“乘3”且非 Hy2 的节点
    filter: "(?i)(?=^(?!.*(家宽|专线|乘[23])).*$)(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Auto Selection: 通过 url-test 测速选择延迟最低的节点
  - name: ♻️ Auto
    type: url-test
    # 筛选规则同 🏴‍☠️ Other 组的基础规则，避免测速包含特定节点
    filter: "(?i)(?=.*(^(?!.*(官网|剩余|流量|套餐|.com)).*$))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点进行测速

  # Fallback Group: 当前节点失败时，按顺序尝试列表中的下一个节点
  - name: ⚙️ Fallback
    type: fallback
    # 筛选规则同 ♻️ Auto 组
    filter: "(?i)(?=.*(^(?!.*(官网|剩余|流量|套餐|.com)).*$))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点进行故障转移
    hidden: true # 在面板中隐藏此组

  # AI Service Group: 用于特定 AI 服务的流量 (例如 ChatGPT)
  # 根据当前配置，筛选台湾节点
  - name: 🤖 AI Service
    type: select
    # 筛选包含“台”、“tw”且非 Hy2 的节点
    filter: "(?i)(?=.*(台|tw))(?=^(?!.*Hy2).*$)^.*$"
    include-all: true # 用于筛选全部可用节点

  # Apple Service Group: 用于苹果相关服务 (App Store, iCloud 等)
  - name: 🍎 APPLE
    type: select
    proxies:
      # 优先直连，然后尝试主代理或其他节点
      - DIRECT
      - 🚀 Proxy
      - 🇭🇰 HK
      - 🇼🇸 TW
      - 🇺🇸 US
      - 🇯🇵 JP
      - 🇸🇬 SG
      - 🏴‍☠️ Other
      - 📉 Low Rate

  # Microsoft Service Group: 用于微软相关服务 (Office, Windows Update 等)
  - name: Ⓜ️ Microsoft
    type: select
    proxies:
      # 优先直连，然后尝试主代理或其他节点
      - DIRECT
      - 🚀 Proxy
      - 🇭🇰 HK
      - 🇼🇸 TW
      - 🇺🇸 US
      - 🇯🇵 JP
      - 🇸🇬 SG
      - 🏴‍☠️ Other
      - 📉 Low Rate


# -------------------------------------------------------
# 规则提供者配置 (rule-providers)
# 定义如何从外部 URL 获取规则集
# -------------------------------------------------------
rule-providers:
  # -------------------- 注释掉的广告拦截规则 (如需使用请取消注释) --------------------
  # reject_non_ip_no_drop:
  #   <<: *RuleSet_classical
  #   url: 'https://ruleset.skk.moe/Clash/non_ip/reject-no-drop.txt'
  #   path: './rule_set/sukkaw_ruleset/reject_non_ip_no_drop.txt'
  #
  # reject_non_ip_drop:
  #   <<: *RuleSet_classical
  #   url: https://ruleset.skk.moe/Clash/non_ip/reject-drop.txt
  #   path: './rule_set/sukkaw_ruleset/reject_non_ip_drop.txt'
  #
  # reject_non_ip:
  #   <<: *RuleSet_classical
  #   url: https://ruleset.skk.moe/Clash/non_ip/reject.txt
  #   path: './rule_set/sukkaw_ruleset/reject_non_ip.txt'
  #
  # reject_domainset:
  #   <<: *RuleSet_domain
  #   url: https://ruleset.skk.moe/Clash/domainset/reject.txt
  #   path: './rule_set/sukkaw_ruleset/reject_domainset.txt'
  #
  # reject_ip:
  #   <<: *RuleSet_classical
  #   url: https://ruleset.skk.moe/Clash/ip/reject.txt
  #   path: './rule_set/sukkaw_ruleset/reject_ip.txt'
  # -----------------------------------------------------------------------------

  # CDN 规则集 (域名和非 IP)
  cdn_domainset:
    <<: *RuleSet_domain
    url: https://ruleset.skk.moe/Clash/domainset/cdn.txt
    path: ./rule_set/sukkaw_ruleset/cdn_domainset.txt

  cdn_non_ip:
    <<: *RuleSet_domain
    url: https://ruleset.skk.moe/Clash/non_ip/cdn.txt
    path: ./rule_set/sukkaw_ruleset/cdn_non_ip.txt

  # 流媒体规则已删除 (根据原配置注释)
  # stream_non_ip:
  # stream_ip:

  # AI 服务规则集 (从 GitHub 获取)
  AI_Service:
    <<: *RuleSet_classical
    url: https://raw.githubusercontent.com/Brian-Lynn/AkashaConfig/main/AI-Service.list
    path: ./rule_set/ai_service.txt # 本地保存路径

  # Telegram 规则集 (非 IP 和 IP)
  telegram_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/telegram.txt
    path: ./rule_set/sukkaw_ruleset/telegram_non_ip.txt

  telegram_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/ip/telegram.txt
    path: './rule_set/sukkaw_ruleset/telegram_ip.txt'

  # Apple 服务规则集 (CDN, 服务, 中国大陆)
  apple_cdn:
    <<: *RuleSet_domain
    url: https://ruleset.skk.moe/Clash/domainset/apple_cdn.txt
    path: ./rule_set/sukkaw_ruleset/apple_cdn.txt

  apple_services:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/apple_services.txt
    path: ./rule_set/sukkaw_ruleset/apple_services.txt

  apple_cn_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/apple_cn.txt'
    path: ./rule_set/sukkaw_ruleset/apple_cn_non_ip.txt

  # Microsoft 服务规则集 (CDN, 主服务)
  microsoft_cdn_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/microsoft_cdn.txt'
    path: ./rule_set/sukkaw_ruleset/microsoft_cdn_non_ip.txt

  microsoft_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/microsoft.txt'
    path: ./rule_set/sukkaw_ruleset/microsoft_non_ip.txt

  # Google 规则集
  google_main:
    <<: *RuleSet_classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Surge/Google/Google.list
    path: ./rule_set/google_main.txt

  google_youtube:
    <<: *RuleSet_classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Surge/YouTube/YouTube_Resolve.list
    path: ./rule_set/google_resolve.txt

  # 软件更新、操作系统等大文件下载规则 (指向低倍率节点组)
  download_domainset:
    <<: *RuleSet_domain
    url: https://ruleset.skk.moe/Clash/domainset/download.txt
    path: ./rule_set/sukkaw_ruleset/download_domainset.txt

  download_non_ip:
    <<: *RuleSet_domain
    url: https://ruleset.skk.moe/Clash/non_ip/download.txt
    path: ./rule_set/sukkaw_ruleset/download_non_ip.txt

  # 个人规则集
  BeanRules:
    <<: *RuleSet_classical
    url: https://raw.githubusercontent.com/Brian-Lynn/AkashaConfig/main/BeanRules.conf
    path: ./rule_set/BeanRules.txt

  # 内网域名和局域网 IP 规则集
  lan_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/lan.txt'
    path: ./rule_set/sukkaw_ruleset/lan_non_ip.txt

  lan_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/ip/lan.txt'
    path: ./rule_set/sukkaw_ruleset/lan_ip.txt

  # 国内域名和 IP 规则集
  domestic_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/domestic.txt'
    path: ./rule_set/sukkaw_ruleset/domestic_non_ip.txt

  # DIRECT 规则集 (直接连接)
  direct_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/direct.txt'
    path: './rule_set/sukkaw_ruleset/direct_non_ip.txt'

  # GLOBAL 规则集 (全局代理，非 IP)
  global_non_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/non_ip/global.txt'
    path: ./rule_set/sukkaw_ruleset/global_non_ip.txt

  # 国内 IP 规则集
  domestic_ip:
    <<: *RuleSet_classical
    url: https://ruleset.skk.moe/Clash/ip/domestic.txt'
    path: './rule_set/sukkaw_ruleset/domestic_ip.txt'

  # 中国 IP 规则集 (CIDR)
  china_ip:
    <<: *RuleSet_ipcidr
    url: https://ruleset.skk.moe/Clash/ip/china_ip.txt'
    path: './rule_set/sukkaw_ruleset/china_ip.txt'

# -------------------------------------------------------
# 规则排序 (rules)
# 流量按顺序匹配规则，匹配到即停止。
# -------------------------------------------------------
rules:
  # 个人规则优先，通常设置为 DIRECT 或特定组
  - RULE-SET,BeanRules,DIRECT

  # 直连或国内流量规则 (优先级较低)
  - RULE-SET,domestic_non_ip,DIRECT
  - RULE-SET,direct_non_ip,DIRECT
  - RULE-SET,lan_non_ip,DIRECT


  # 特定服务规则
  - RULE-SET,AI_Service,🤖 AI Service # AI 服务流量指向 AI Service 组
  - RULE-SET,telegram_non_ip,✈️ Telegram # Telegram (非 IP) 流量指向 Telegram 组


  # Google 规则 (YouTube 独立分流)
  - RULE-SET,google_youtube,▶️ YouTube # YouTube 流量指向 YouTube 组
  - RULE-SET,google_main,🌐 Google # 其他 Google 流量指向 Google 组

  # Apple 服务规则
  - RULE-SET,apple_cdn,DIRECT # Apple CDN 流量直连
  - RULE-SET,apple_cn_non_ip,🍎 APPLE # 中国大陆 Apple 服务流量指向 Apple 组
  - RULE-SET,apple_services,🍎 APPLE # 其他 Apple 服务流量指向 Apple 组

  # Microsoft 服务规则
  - RULE-SET,microsoft_cdn_non_ip,DIRECT # Microsoft CDN 流量直连
  - RULE-SET,microsoft_non_ip,Ⓜ️ Microsoft # 其他 Microsoft 服务流量指向 Microsoft 组

  # 大文件下载规则 (指向低倍率节点组)
  - RULE-SET,download_domainset,📉 Low Rate
  - RULE-SET,download_non_ip,📉 Low Rate

  # -------------------- 注释掉的广告拦截规则 (如需使用请取消注释) --------------------
  # - RULE-SET,reject_non_ip,REJECT
  # - RULE-SET,reject_domainset,REJECT
  # - RULE-SET,reject_non_ip_drop,REJECT-DROP
  # - RULE-SET,reject_non_ip_no_drop,REJECT

  # -----------------------------------------------------------------------------

  # CDN 规则 (使用主代理)
  - RULE-SET,cdn_domainset,🚀 Proxy
  - RULE-SET,cdn_non_ip,🚀 Proxy

  # 全局代理规则 (非 IP)
  - RULE-SET,global_non_ip,🚀 Proxy



  # IP 类规则
  - RULE-SET,telegram_ip,✈️ Telegram # Telegram (IP) 流量指向 Telegram 组
  - RULE-SET,lan_ip,DIRECT
  - RULE-SET,domestic_ip,DIRECT
  - RULE-SET,china_ip,DIRECT
  # - RULE-SET,reject_ip,REJECT


  # 默认规则：所有未匹配上述规则的流量都将指向主代理组
  - MATCH,🚀 Proxy
